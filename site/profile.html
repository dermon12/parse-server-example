<!DOCTYPE htmla>
<html>
<title>Backseat</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://code.jquery.com/jquery-2.2.4.min.js">
</script> 
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script src="site/js/ajaxforms.js"></script>
<script src="site/js/profile.js"></script>
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
<style>
.file {
  position: relative;
  text-align: center;
  
}
.file label {
  background: #3b5998;
      display: block;
    margin: 10px 0;
    padding: 10px;
    width: 100%;
  color: #fff;
  font-weight: bold;
  font-size: .9em;
  transition: all .4s;
}
.file input {
  position: absolute;
  display: inline-block;
  left: 0;
  top: 0;
  opacity: 0.01;
  cursor: pointer;
}
.file input:hover + label,
.file input:focus + label {
  background: #34495E;
  color: #39D2B4;
}
.loader {
  display :none;
  position: fixed;
  margin-top: -50px;
  margin-left: -50px;
  top: 50%;
  left: 50%;
  border: 16px solid #f3f3f3;
  border-radius: 50%;
  border-top: 16px solid #3498db;
  width: 120px;
  height: 120px;
  -webkit-animation: spin 2s linear infinite;
  animation: spin 2s linear infinite;
}

@-webkit-keyframes spin {
  0% { -webkit-transform: rotate(0deg); }
  100% { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
/* The Modal (background) */
.modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1; /* Sit on top */
    padding-top: 100px; /* Location of the box */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: rgb(0,0,0); /* Fallback color */
    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
    background-color: #3b5998;
    margin: auto;
    text-align: center;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
}

/* The Close Button */
.close {
    color: #aaaaaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
}

.close:hover,
.close:focus {
    color: #000;
    text-decoration: none;
    cursor: pointer;
}
	
	
body, h1,h2,h3,h4,h5,h6 {font-family: "Montserrat", sans-serif}
.w3-row-padding img {margin-bottom: 12px}
.bgimg {
    background-position: center;
    background-repeat: no-repeat;
    background-size: cover;
    min-height: 100%;
    background-image: url(url());
}

table {
    font-family: arial, sans-serif;
    border-collapse: collapse;
    width: 100%;
}

td, th {
    border: 1px solid #dddddd;
    text-align: left;
    padding: 8px;
}

/* General Styles */
* {
  
   box-sizing:border-box;
   -webkit-box-sizing:border-box;
   -moz-box-sizing:border-box;
   -webkit-font-smoothing:antialiased;
   -moz-font-smoothing:antialiased;
   -o-font-smoothing:antialiased;
   font-smoothing:antialiased;
   text-rendering:optimizeLegibility;
}
body {
   /*color: #C0C0C0;*/
  text-align: right;
   font-family: Arial, san-serif;
}


/* Contact Form Styles */
h1 {
   margin: 10px 0 0 0;
  
}
h4{
   margin: 0 0 20px 0;
}
#contact-form input,   
#contact-form select,   
#contact-form textarea,   
#contact-form label { 
    text-align: right;
   font-size: 15px;  
   width: 100%;
   margin-bottom: 2px;
   font-family: Arial, san-serif;
} 
#contact-form input,   
#contact-form select,   
#contact-form textarea { 
    text-align: right;
   width:100%;
   background: #fff;
   border: 0; 
   -moz-border-radius: 4px;  
   -webkit-border-radius: 4px;  
   border-radius: 4px;
   margin-bottom: 25px;  
   padding: 5px;  
}  
#contact-form input:focus,   
#contact-form select:focus,   
#contact-form textarea:focus {  
   background-color: #E5E6E7; 
}  
#contact-form textarea {
   width:100%;
   height: 150px;
}
#contact-form button[type="submit"] {
   cursor:pointer;
   width:100%;
   border:none;
   background:#3b5998;
   background-image:linear-gradient(bottom, #8C1C50 0%, #991D57 52%);
   color:#FFF;
   margin:0 0 5px;
   padding:10px;
   border-radius:5px;
}
.addfriend {
   cursor:pointer;
   width:100%;
   border:none;
   background:#991D57;
   background-image:linear-gradient(bottom, #8C1C50 0%, #991D57 52%);
   color:#FFF;
   margin:0 0 5px;
   padding:10px;
   border-radius:5px;
}
#contact-form button[type="submit"]:hover {
   background-image:linear-gradient(bottom, #9C215A 0%, #A82767 52%);
   -webkit-transition:background 0.3s ease-in-out;
   -moz-transition:background 0.3s ease-in-out;
   transition:background-color 0.3s ease-in-out;
}
#contact-form button[type="submit"]:active {
   box-shadow:inset 0 1px 3px rgba(0,0,0,0.5);
}
input:required, textarea:required {  
   box-shadow: none;
  
   -moz-box-shadow: none;  
   -webkit-box-shadow: none;  
   -o-box-shadow: none;  
} 
#contact-form .required {  
   font-weight:bold;  
   color: #E5E6E7;      
}

/* Hide success/failure message
   (especially since the php is missing) */
#failure, #success {
   color: #6EA070; 
   display:none;  
}

/* Make form look nice on smaller screens */
@media only screen and (max-width: 580px) {
   #contact-form{
      left: 3%;
      margin-right: 3%;
      width: 88%;
      margin-left: 0;
      padding-left: 3%;
      padding-right: 3%;
   }
}


.login-block {
    width: 100%;
    
    padding: 10px;
    border-radius: 5px;
    margin: 0 auto;
}

.login-block h1 {
    text-align: center;
    color: #000;
    font-size: 18px;
    text-transform: uppercase;
    margin-top: 0;
    margin-bottom: 20px;
}

.login-block input {
    width: 100%;
    height: 42px;
    box-sizing: border-box;
    border-radius: 5px;
    border: 1px solid #ccc;
    margin-bottom: 20px;
    font-size: 14px;
    font-family: Montserrat;
    padding: 0 20px 0 50px;
    outline: none;
}

.login-block input#username {
    background: #fff url('http://i.imgur.com/u0XmBmv.png') 20px top no-repeat;
    background-size: 16px 80px;
}

.login-block input#username:focus {
    background: #fff url('http://i.imgur.com/u0XmBmv.png') 20px bottom no-repeat;
    background-size: 16px 80px;
}

.login-block input#password {
    background: #fff url('http://i.imgur.com/Qf83FTt.png') 20px top no-repeat;
    background-size: 16px 80px;
}

.login-block input#password:focus {
    background: #fff url('http://i.imgur.com/Qf83FTt.png') 20px bottom no-repeat;
    background-size: 16px 80px;
}

.login-block input:active, .login-block input:focus {
    border: 1px solid #ff656c;
}

.login-block button {
    width: 100%;
    height: 40px;
    background:#3b5998;
    color: #fff;
    font-weight: bold;
    text-transform: uppercase;
    font-size: 14px;
    font-family: Montserrat;
    outline: none;
    cursor: pointer;
}

.login-block button:hover {
    background: #ff7b81;
}

.photo {
    background-repeat: no-repeat;
    background-position: 50%;
    position: absolute;
  width: 180px;
  height: 180px;
  float: left;
  border-radius: 100%;

}
.textincont{
	width : auto;
    text-shadow: 2px 2px #FFFFFF;
        position: absolute;
    text-align: left;
    padding-left: 150px;
}
.content{
    width: auto;
    height:250px;
    overflow: hidden;
}
.totalscore{
text-align :center;
margin-bottom : 30px;
color:	#8E9AA5;
font-size:20px;
}
.adddriver{
        background-color: Transparent;
        border-color:#323637;
    padding: 10px 30px;
    text-align: center;
    -webkit-text-stroke-width: 0.1px;
    border-radius: 10px;
    font-size: 16px;
    border-style: solid;
    border-width: 2px;
    cursor: pointer;
  border-radius: 10%;
}
.fadein, .fadeout {
    opacity: 0;
    -moz-transition: opacity 0.4s ease-in-out;
    -o-transition: opacity 0.4s ease-in-out;
    -webkit-transition: opacity 0.4s ease-in-out;
    transition: opacity 0.4s ease-in-out;
}
.fadein {
    opacity: 1;
}
.SendReq{
height : 0px;
}
.edit{
z-index: 1000;
padding:20px;
  position:absolute;
  border-radius: 50%;
  border: 1px solid black;
  background:#000;

  left: 0px;
}
.form{
  height : 0;
  overflow: hidden;
}
.ScoreBoard{
      height : 0;
  overflow: hidden;
}
.plusbutton{
z-index: 1000;
  position:absolute;
     -webkit-text-stroke-width: 2px;
   -webkit-text-stroke-color: black;
  font-size:22px;
      border: none;
    background-color: Transparent;

}
.microphone{

z-index: 1000;
padding:20px;
left:0;
  position:absolute;
  background-color: Transparent;
  border:none
}
.modal-dialog{
  background: #fefefe;
  border: @gray solid 1px;
  border-radius: 5px;
  margin-left: -150px;
  position: fixed; 
  left: 50%; 
  top: -100%;  
  z-index: 1100; 
  width: 300px;
}

.modal-body{
  padding: @space/2;
  text-align:center;
}

.modal-header,
.modal-footer{
  padding: @space/4 @space/2;
}

.modal-header{
  border-bottom: @gray-lighter solid 1px;
  
  h2{
    font-size: 20px;
  }
  
}

.modal-footer{
  border-top: @gray-lighter solid 1px;
  text-align: right;
}
</style>

<style type="text/css">
   body { background:  #A6B7BF !important; } 
</style>
<body>
<div class="loader"></div>
<!-- Sidebar with image -->
<nav class="w3-sidebar w3-hide-medium w3-hide-small" style="width:40%">
  <div class="bgimg"></div>
</nav>
<!-- Hidden Sidebar (reveals when clicked on menu icon)-->
<nav class="w3-sidebar w3-black w3-animate-right w3-xxlarge" style="display:none;padding-top:15px;right:0;z-index:2" id="mySidebar">
  <a href="javascript:void(0)" onclick="closeNav()" class="w3-button w3-black w3-xlarge w3-display-topright" style="padding:0 12px;">
    <i class="fa fa-remove"></i>
  </a>
  <div class="w3-bar-block w3-center">
    <a href="#" style="font-size: 70%;" class="w3-bar-item w3-button w3-text-grey w3-hover-black" onclick="closeNav()">בית</a>
    <a href="#FriendsList" style="font-size: 70%;" class="w3-bar-item w3-button w3-text-grey w3-hover-black" onclick="closeNav()">רשימת חברים</a>
    <a href="#SendReq" style="font-size: 70%;" class="w3-bar-item w3-button w3-text-grey w3-hover-black" onclick="closeNav()">בקשת חברות</a>
    <a href="#UpdateIMG" style="font-size: 70%;" class="w3-bar-item w3-button w3-text-grey w3-hover-black" onclick="closeNav()">עדכון תמונה</a>
    <a href="#ChooseClass" style="font-size: 70%;" class="w3-bar-item w3-button w3-text-grey w3-hover-black" onclick="closeNav()">עדכון כתה</a>
    <a href="#ScoreBoard" style="font-size: 70%;" class="w3-bar-item w3-button w3-text-grey w3-hover-black" onclick="closeNav()">לוח תוצאות</a>
    <a href="/logout" style="font-size: 70%;" class="w3-bar-item w3-button w3-text-grey w3-hover-black" onclick="closeNav()">התנתק</a>
  </div>
</nav>

<!-- Page Content -->
<div class="w3-main w3-padding-large" style="margin-left:40%">

  <!-- Menu icon to open sidebar -->
  <span class="w3-button w3-top w3-white w3-xxlarge w3-text-grey w3-hover-text-black" style="opacity:0.4;width:auto;right:0;" onclick="openNav()"><i class="fa fa-bars"></i></span>


	
  <!-- Header -->

  <div class="content">
      
  <header class="photo" id="home">
<button class= "edit fa fa-pencil fa-lg" id ="file"/>
  </header>
      <h1 class="textincont"><b></b></h1>
  </div>
  
  <div class="totalscore"><b>ניקוד כולל: </b></div>
  <button class="adddriver" id="addfrien"><b>הוסף נהג</b></button>
	
	<!---<div class="UpdateIMG" id="UpdateIMG">
	    <h2>עדכן תמונת פרופיל</h2>
	  <form method="post" id = "imgform" action="/updateimg">
	  <p class="file">
	    <input type="file" name="file" accept="image/*" id="file" />
	    <label for="file">בחר תמונה</label>
	  </p>
	</form>

	  </div>-->
	
		<div style="display:none;" class="UpdateIMG" id="UpdateIMG">
	    <h2>עדכן תמונת פרופיל</h2>
	      <form ref='uploadForm' 
	      id='imgform' 
	      action='/updateimg' 
	      method='post' 
	      encType="multipart/form-data">
		<p class="file">
	    <input type="file" name="file" accept="image/*" id="fileform" />
	    <label for="file">בחר תמונה</label>
	  </p>
	    </form>     

	  </div>
	
	
	<div style="display:none;" class="SendRecord" id="SendRecord">
	    <h2>שלח הקלטה</h2>
	      <form ref='uploadForm' 
	      id='SendReqForm' 
	      action='/sendreq' 
	      method='post' 
	      encType="multipart/form-data">
		<p class="file">
	    <input type="text" name="mobile" id = "recordto" value="">
	    <input type="file" name="file" accept="audio/*" id="reqform" />
	    <label for="file">בחר הקלטה</label>
	  </p>
	    </form>     

	  </div>
	
	
	
	
      	<div class="FriendsList" id="FriendsList">
        	    <h2>רשימת חברים</h2> 
  <div class="top">
  </div>
  <div class="row"  >

    <div class="shadow" id = "shadow" >
    
     
  </div>
</div>
          
                
	  </div>
	
	      <div class="modal-req" id="modal-one">
  <div class="modal-dialog">
    <div class="modal-body">
      <p id = "textinreqmodal">One modal example here! :D</p>
    </div>
   <div style="text-align:center;" class="modal-footer">
      <a onclick="closereq()" class="btn">הבנתי</a>
    </div>
  </div>
</div>
	
      
    	<div class="SendReq fadeout" id="SendReq">
	    <h2>שליחת בקשת חברות</h2>  
        <div class="login-block">
    <input dir = "rtl" type="number" value="" placeholder="הקלד מספר טלפון" id="phonenumber" />
            
<button name="addfriend" class="addfriend" onclick="sendrequest()" > שליחת בקשת חברות</button>

</div>     
</div>
        



      <div class="ChooseClass" id="ChooseClass">
      <button class="plusbutton" onclick="fader('form');"> ﹢</button>
    <h2 >עדכן כתה</h2>
          <!-- 
  ****************************************
  Contest Entry for Treehouse:
  "Design a Contact Form"
  Submitted by Lisa Wagner
  ****************************************
-->
<div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <span class="close">&times;</span>
    <p id = "alerttet">Some text in the Modal..</p>
  </div>

</div>
	      
	      
	      
<div id="contact-form">
  <form class="form fadeout" id="form" method="post" action=
  "/updateclass">
    <div>
      <label for="school"><span>:בית ספר</span> <select dir="rtl"
      id="school" name="school" tabindex="4">
        <option value="0">
          בית ספר רמת חן
        </option>
      </select> <label for="class"><span>שכבה:</span> <select dir=
      "rtl" id="class" name="class" tabindex="4">
        <option value="4">
          ד
        </option>
        <option value="5">
          ה
        </option>
        <option value="6">
          ו
        </option>
        <option value="7">
          ז
        </option>
        <option value="8">
          ח
        </option>
      </select></label> <label for="number"><span>מספר כתה:</span>
      <select dir="rtl" id="number" name="number" tabindex="4">
        <option value="1">
          1
        </option>
        <option value="2">
          2
        </option>
        <option value="3">
          3
        </option>
        <option value="4">
          4
        </option>
        <option value="5">
          5
        </option>
        <option value="6">
          6
        </option>
        <option value="7">
          7
        </option>
        <option value="8">
          8
        </option>
        <option value="9">
          9
        </option>
        <option value="10">
          10
        </option>
      </select></label></label>
      <div>
        <button name="submit" id="submit" type="submit" onclick=
        "openloader()">עדכון כתה</button>
      </div>
    </div>
  </form>
</div>
   
       
     <button  class="plusbutton" onclick="fader('ScoreBoard');"> ﹢</button>
  <!-- About Section -->
  <h2>לוח תוצאות</h2>
  <div  class="ScoreBoard fadeout" id="ScoreBoard">
    
    <table class = "Scorer" id="Scorer">
      <tr>
        <th>כתה</th>
        <th>ניקוד</th>
    </tr>
    </table>
  <!-- End About Section -->
  </div>
 </div>
 </div>
 
</body> 
</html>
 
    

 
  
<!-- END PAGE CONTENT -->
</div>


<!-- Add Google Maps -->
<script>


// Open and close sidebar
function openNav() {
    document.getElementById("mySidebar").style.width = "60%";
    document.getElementById("mySidebar").style.display = "block";
}

function closeNav() {
    document.getElementById("mySidebar").style.display = "none";
}
var modal = document.getElementById('myModal');
var span = document.getElementsByClassName("close")[0];
span.onclick = function() {
    modal.style.display = "none";
}

function openalert(text) {
    document.getElementById("alerttet").innerHTML  = text;
    modal.style.display = "block";
}
function openloader() {
    document.getElementsByClassName("loader")[0].style.display = "block";
}
function sendrequest(){

	var number = document.getElementById("phonenumber").value;
	if(number.length != 10 || !number.startsWith("05")){
    	closeloader();
        openalert("אנא הקלד מספר טלפון תקין בן 10 ספרות");
    }
    else
    {
    openloader();
    //var xmlHttp = new XMLHttpRequest();
    //xmlHttp.open( "GET", "https://back-seat.herokuapp.com/addfriend?num=" + number , false ); // false for synchronous request
    //xmlHttp.send( null );
    //var r = xmlHttp.responseText;
    $.get("https://back-seat.herokuapp.com/addfriend?num=" + number, function(data, status){
            openalert(data);
	    closeloader();
    	});
	    
	    
	    

    
    
    }
    
}


function closeloader() {
    document.getElementsByClassName("loader")[0].style.display = "none";
}
document.getElementById("file").onclick = function() {
document.getElementById("fileform").click(); // Click on the checkbox
};
	
	
document.getElementById("fileform").onchange = function() {
    openloader();
	document.getElementById("imgform").submit();
	/*var data = new FormData();
	jQuery.each(jQuery('#imgform')[0].files, function(i, file) {
	    data.append('file1', file);
	});
	alert(JSON.stringify(data));
	
       $.ajax({
           type: "POST",
           url: "/updateimg",
           // serialize your form's elements.
           data: data.file1, 
           success: function(data)
           {
	   	closeloader();
               // "something" is the class of your form wrapper
               alert(data);
           }
         });*/
};
	
	
	
$("#form").submit(function() {
	
    $.ajax({
           type: "POST",
           url: "/updateclass",
           // serialize your form's elements.
           data: $("#form").serialize(), 
           success: function(data)
           {
	   	closeloader();
               // "something" is the class of your form wrapper
               if(data === "success")
	       {
		     openalert("!עדכון הכתה בוצע");  
	       }
		   else
		   {
			openalert("אופס... משהו השתבש"); 
		   }
           }
         });
    // avoid to execute the actual submit of the form.
    return false;
});
$("#addfrien").click(function () {
    if ($("#SendReq").hasClass("fadeout")){
    
        $("#SendReq").removeClass("fadeout").addClass("fadein");
        	document.getElementsByClassName("SendReq")[0].style.height = "auto";
            document.getElementsByClassName("FriendsList")[0].style.display = "none";
        }
    else
    {
        $("#SendReq").removeClass("fadein").addClass("fadeout");
                	  setTimeout(
                      function() {                               document.getElementsByClassName("SendReq")[0].style.height = "0px";
                                          document.getElementsByClassName("FriendsList")[0].style.display = "block";
                      }, 300);
                                           
        }
});


function fader(clastofade){
    if ($('#' + clastofade).hasClass("fadeout"))
    {
        $('#' + clastofade).removeClass("fadeout").addClass("fadein");
        document.getElementsByClassName(clastofade)[0].style.height = "auto";
     }   
    else
    {
        $('#' + clastofade).removeClass("fadein").addClass("fadeout");
        setTimeout(
        function() {                       document.getElementsByClassName(clastofade)[0].style.height = "0px";
                                        
                      }, 300);    
	}
};
var mobileto = "";
function managesendreq(record){
	mobileto = record.getAttribute("data-mobile");
	document.getElementById("textinreqmodal").innerHTML = record.getAttribute("data-name") + " אתה עומד לשלוח הקלטה אל" + "<br><br/>";
	document.getElementById("textinreqmodal").innerHTML += "אנא בחר קובץ קול באורך של כ-3 שניות";
	document.getElementsByClassName("modal-dialog")[0].style.top = "20%";
}
function closereq(){
	document.getElementsByClassName("modal-dialog")[0].style.top = "-100%";	
	document.getElementById("recordto").value = mobileto;
	document.getElementById("reqform").click(); // Click on the checkbox
}
document.getElementById("reqform").onchange = function() {
	var x = document.getElementById("reqform").files[0];
	alert(x.size);
	if(x.size > 67.5 && x.size < 82.5){
	openloader();
	//document.getElementById("SendReqForm").submit();
	}
	else{
		openalert("ההקלטה צריכה להיות באורך של כ-3 שניות");
	}
};
	
	

$('body').on('mousedown touchstart','.microphone', function(e) {  
    managesendreq(this);
});
	
	
	
</script>

